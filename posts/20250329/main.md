---
Keywords: 自作シェル,rusty_bash,寿司シェル
Copyright: (C) 2025 Ryuichi Ueda
---

# 自作シェルの最近の話題

　なんか春休みで研究そっちのけで自作シェル（[rusty_bash、sush、寿司シェルといろんな呼び名で呼ばれているやつ](https://github.com/shellgei/rusty_bash/)）を開発してます。（研究以外の仕事はちゃんとやってますねんのため。）

　最近はポツポツと海外からのissueが来てます。Bashみたいなデカいシェルをほぼスクラッチ状態から作るのは手分けしたとしても時間がかかるので、たぶんそんなアホなことやってる人は地球上でそんなにおらんだろうと思います。

## Bashのテスト使えと指摘されて使い出した

　海外から「ちゃんとBashのリポジトリにあるテストを使え。グラフも描け」と言われで、対応しました。

* これ: https://github.com/shellgei/rusty_bash/issues/124#issue-2888738573

Bashの公式リポジトリは[ココ](https://savannah.gnu.org/git/?group=bash)にありますが、そのリポジトリの中に`tests`というディレクトリがあり、そのなかにテストスクリプトが入ってます。使い方はこんな感じ。（手練れ向けで、細かいトラップまで考慮してないのでご容赦ください。）

1. リポジトリのなかで`./configure`して`make`
2. 最新のUbuntuだと一箇所「ヘッダファイルが明示的に指定されていない」とエラーが出るので修正
3. `make test`あるいは`tests`のなかで、`THIS_SH=<テストしたいシェル> ./hogehoge.test`を実行

みなさんも手持ちのシェルで試してみてください（？）

　で、このリポジトリをフォークして、[自作シェルのテスト用のリポジトリ](https://github.com/ryuichiueda/bash_for_sush_test)を作りました。このなかの`sush_test`というディレクトリのなかに、Bashと自作シェルを比較するためのシェルスクリプトと、gnuplotでグラフを描くシェルスクリプトを置きました。最初は`rusty_bash`のリポジトリの中に

## Bashのテストへの対応

　Bashのテスト、エッジケースが多い上にテストスクリプト自体がbash-completion並みに変態なので、それに対応せねばならずいろいろ調べてました。

### functionと書けば`()`が省略できる

### Bashのglobstarは同じパスを何回も出す

### IFS地獄
